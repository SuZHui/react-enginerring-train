{"version":3,"file":"js/Battle.6aec4aa6.js","mappings":"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","sources":["webpack://react-enginerring-train/./src/api/index.js","webpack://react-enginerring-train/./src/pages/Battle/Instructions.jsx","webpack://react-enginerring-train/./src/components/PlayerInput/style.module.scss?2d8e","webpack://react-enginerring-train/./src/components/PlayerInput/index.jsx","webpack://react-enginerring-train/./src/pages/Battle/index.jsx"],"sourcesContent":["import Axios from \"axios\";\nimport { Modal } from \"antd\";\nimport useSWRInfinite from \"swr/infinite\";\nimport useSWR from \"swr\";\n\nlet modal;\n\nconst client = Axios.create({});\nclient.interceptors.response.use(\n  (res) => res.data,\n  (err) => {\n    if (Axios.isCancel(err)) {\n      // eslint-disable-next-line no-console\n      console.info(\"Request canceled\", err);\n    } else if (!modal) {\n      // 系统级错误 弹窗提示\n      const message = (() => {\n        let t = \"Request failed\";\n        if (err.response && err.response.data) {\n          t = err.response.data.message || t;\n        } else if (err.message) {\n          t = err.message;\n        }\n        return t;\n      })();\n      modal = Modal.error({\n        title: \"Error\",\n        content: message,\n        afterClose: () => {\n          modal = null;\n        },\n      });\n    }\n    return Promise.reject(err);\n  }\n);\n\nexport default {\n  getList(t) {\n    const fetcher = (url) => client.get(url);\n    const type = t.toLowerCase() !== \"all\" ? `+language:${t}` : \"\";\n    const getKey = (index) =>\n      `https://api.github.com/search/repositories?q=stars:%3E1${type}&sort=stars&order=desc&type=Repositories&per_page=30&page=${\n        index + 1\n      }`;\n    const { data, mutate, ...others } = useSWRInfinite(getKey, fetcher, {\n      shouldRetryOnError: false,\n      revalidateFirstPage: false,\n    });\n    return {\n      ...others,\n      data: Array.isArray(data)\n        ? data.reduce((a, c = {}) => {\n            const { items = [] } = c;\n            a.push(...items);\n            return a;\n          }, [])\n        : [],\n      reload: () => mutate(data),\n    };\n  },\n  getUser(name) {\n    return client.get(`https://api.github.com/users/${name}`);\n  },\n  getUser2(name) {\n    const key = name ? `https://api.github.com/users/${name}` : null;\n    const fetcher = (url) => client.get(url);\n    return useSWR(key, fetcher, {\n      shouldRetryOnError: false,\n      revalidateOnFocus: false,\n    });\n  },\n};\n","import React from \"react\";\nimport { Row, Col } from \"antd\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport {\n  faUsers,\n  faFighterJet,\n  faTrophy,\n} from \"@fortawesome/free-solid-svg-icons\";\n\nexport default function Instructions() {\n  return (\n    <div>\n      <h2 className=\"tc\">Instructions</h2>\n      {/* className=\"flex justify-center\" */}\n      <Row justify=\"center\">\n        <Col\n          xs={{ span: 16 }}\n          sm={{ span: 8 }}\n          md={{ span: 6 }}\n          lg={{ span: 4 }}\n          xxl={3}\n        >\n          <div className=\"tc mb4\">\n            <p className=\"fw6\">Enter Two Github</p>\n            <div className=\"pa4 bg-light-gray mh3\">\n              <FontAwesomeIcon\n                icon={faUsers}\n                size=\"5x\"\n                color=\"#ffbf74\"\n                fixedWidth\n              />\n            </div>\n          </div>\n        </Col>\n        <Col\n          xs={{ span: 16 }}\n          sm={{ span: 8 }}\n          md={{ span: 6 }}\n          lg={{ span: 4 }}\n          xxl={3}\n        >\n          <div className=\"tc mb4\">\n            <p className=\"fw6\">Battle</p>\n            <div className=\"pa4 bg-light-gray mh3\">\n              <FontAwesomeIcon\n                icon={faFighterJet}\n                size=\"5x\"\n                color=\"gray\"\n                fixedWidth\n              />\n            </div>\n          </div>\n        </Col>\n        <Col\n          xs={{ span: 16 }}\n          sm={{ span: 8 }}\n          md={{ span: 6 }}\n          lg={{ span: 4 }}\n          xxl={3}\n        >\n          <div className=\"tc mb4\">\n            <p className=\"fw6\">See The Winner</p>\n            <div className=\"pa4 bg-light-gray mh3\">\n              <FontAwesomeIcon\n                icon={faTrophy}\n                size=\"5x\"\n                color=\"rgb(244, 234, 42)\"\n                fixedWidth\n              />\n            </div>\n          </div>\n        </Col>\n      </Row>\n    </div>\n  );\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"input\":\"src-components-PlayerInput-style-module__input--UXaxD\"};","import React, { useState, useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Input, Button, Image, Spin } from \"antd\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faTimesCircle } from \"@fortawesome/free-solid-svg-icons\";\nimport { useFormik } from \"formik\";\nimport API from \"@/api\";\nimport styles from \"./style.module.scss\";\n\nconst usePlayerInput = () => {\n  const [isLoading, setLoading] = useState(false);\n  const [player, setPlayer] = useState(null);\n  const listener = useRef({\n    error: null,\n  });\n\n  const fetch = (name) => {\n    setLoading(true);\n    API.getUser(name)\n      .then((res) => {\n        setPlayer(res);\n      })\n      .catch((err) => {\n        // console.error(err);\n        setPlayer(null);\n        if (listener.current.error) {\n          listener.current.error(err);\n        }\n      })\n      .finally(() => {\n        setLoading(false);\n      });\n  };\n\n  return {\n    player,\n    isLoading,\n    submit: fetch,\n    onError: (cb) => {\n      listener.current.error = cb;\n    },\n    clearPlayer: () => setPlayer(null),\n  };\n};\nexport default function PlayerInput({ onChange }) {\n  const { player, isLoading, submit, clearPlayer, onError } = usePlayerInput();\n  const formik = useFormik({\n    initialValues: {\n      name: \"\",\n    },\n    onSubmit: (values) => {\n      const name = values.name.toLowerCase();\n      submit(name);\n      onChange(name);\n    },\n  });\n\n  const handleClear = () => {\n    clearPlayer();\n    formik.setValues({ name: \"\" });\n    onChange(null);\n  };\n\n  /**\n   * TODO: 是否需要调整\n   * 在触发错误的时候并不会清空输入框中的输入内容\n   * 但是会触发onChange事件\n   * 此时组件内外的数据将会出现不同步的情况\n   * 即 父组件（监听方）数据被清空，而子组件（调用方）输入状态却还保留\n   */\n  onError(() => {\n    clearPlayer();\n    onChange(null);\n  });\n\n  // const style = {\n  //   width: 'calc(100% - 86px)',\n  //   maxWidth: 246\n  // }\n  return player ? (\n    <div className=\"br3 bg-light-gray flex items-center justify-between pa2\">\n      <div className=\"flex items-center\">\n        <Image\n          className=\"br3\"\n          src={player.avatar_url}\n          width={48}\n          height={48}\n          preview={false}\n          placeholder={\n            <div className=\"flex items-center justify-center h-100\">\n              <Spin />\n            </div>\n          }\n        />\n        <span className=\"ml2 fw6 f3 blue\">{player.login}</span>\n      </div>\n      {/* eslint-disable-next-line jsx-a11y/click-events-have-key-events */}\n      <div className=\"pointer\" onClick={handleClear} role=\"button\" tabIndex=\"0\">\n        <FontAwesomeIcon icon={faTimesCircle} color=\"red\" size=\"2x\" />\n      </div>\n    </div>\n  ) : (\n    <Input.Group compact size=\"large\">\n      <Input\n        name=\"name\"\n        className={styles.input}\n        maxLength={30}\n        value={formik.values.name}\n        disabled={isLoading}\n        onChange={formik.handleChange}\n        onPressEnter={formik.handleSubmit}\n        placeholder=\"github username\"\n      />\n      <Button\n        size=\"large\"\n        type=\"primary\"\n        loading={isLoading}\n        disabled={!formik.values.name}\n        onClick={formik.handleSubmit}\n      >\n        Submit\n      </Button>\n    </Input.Group>\n  );\n}\n\nPlayerInput.defaultProps = {\n  onChange() {},\n};\n\nPlayerInput.propTypes = {\n  onChange: PropTypes.func,\n};\n","import React, { useState } from \"react\";\nimport { useNavigate, createSearchParams } from \"react-router-dom\";\nimport { Row, Col, Button } from \"antd\";\nimport Instructions from \"./Instructions\";\nimport PlayerInput from \"@/components/PlayerInput\";\n\nexport default function Battle() {\n  const navigate = useNavigate();\n  const [model, setModel] = useState({\n    p1: null,\n    p2: null,\n  });\n\n  const setP1 = (p) => setModel({ ...model, p1: p });\n  const setP2 = (p) => setModel({ ...model, p2: p });\n  // 跳转至结果页\n  const handleBattle = () => {\n    navigate({\n      pathname: \"/result\",\n      search: `?${createSearchParams({\n        p1: model.p1,\n        p2: model.p2,\n      })}`,\n    });\n  };\n\n  return (\n    <div className=\"page pt6\">\n      <Instructions />\n      <div className=\"pb4\">\n        <h2 className=\"tc mb3\">Players</h2>\n        <Row justify=\"center\">\n          <Col xs={20} md={10}>\n            <div className=\"ph4 tc\">\n              <h2>Player One</h2>\n              <PlayerInput onChange={setP1} />\n            </div>\n          </Col>\n          <Col xs={20} md={10}>\n            <div className=\"ph4 tc\">\n              <h2>Player Two</h2>\n              <PlayerInput onChange={setP2} />\n            </div>\n          </Col>\n        </Row>\n        {model.p1 && model.p2 && (\n          <Row justify=\"center\" className=\"pv5\">\n            <Button type=\"primary\" size=\"large\" onClick={handleBattle}>\n              Battle\n            </Button>\n          </Row>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":["modal","client","Axios","interceptors","response","use","res","data","err","console","info","message","t","Modal","title","content","afterClose","Promise","reject","getList","type","toLowerCase","useSWRInfinite","index","url","get","shouldRetryOnError","revalidateFirstPage","mutate","Array","isArray","reduce","a","c","items","push","reload","getUser","name","getUser2","key","useSWR","revalidateOnFocus","Instructions","className","justify","xs","span","sm","md","lg","xxl","icon","faUsers","size","color","fixedWidth","faFighterJet","faTrophy","PlayerInput","onChange","useState","isLoading","setLoading","player","setPlayer","listener","useRef","error","submit","API","then","current","onError","cb","clearPlayer","usePlayerInput","formik","useFormik","initialValues","onSubmit","values","src","avatar_url","width","height","preview","placeholder","login","onClick","setValues","role","tabIndex","faTimesCircle","compact","styles","maxLength","value","disabled","handleChange","onPressEnter","handleSubmit","loading","Battle","navigate","useNavigate","p1","p2","model","setModel","p","pathname","search","createSearchParams","defaultProps","propTypes","PropTypes"],"sourceRoot":""}